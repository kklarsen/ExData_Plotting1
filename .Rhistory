lines(Sub_metering_3, col = "blue")
ymax1 <- max(dataPECsub$Sub_metering_1)
ymax2 <- max(dataPECsub$Sub_metering_2)
ymax3 <- max(dataPECsub$Sub_metering_3)
ymax <- 10*round(max(ymax1,ymax2,ymax3)/10, digits = 0)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
with(dataPECsub, lines(Sub_metering_2, col = "red")
with(dataPECsub, lines(Sub_metering_3, col = "blue")
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"),
plot(Date, Sub_meteric_2), plot(Date, Sub_metering_3)
)
parse(new = T)
with(dataPECsub, lines(Sub_metering_2, col = "red")
parse(new = T)
with(dataPECsub, lines(Sub_metering_3, col = "blue")
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2, col = "red")
lines(dataPECsub$Sub_metering_3, col = "blue")
ymax1 <- max(dataPECsub$Sub_metering_1)
ymax2 <- max(dataPECsub$Sub_metering_2)
ymax3 <- max(dataPECsub$Sub_metering_3)
ymax <- 10*round(max(ymax1,ymax2,ymax3)/10, digits = 0)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2, col = "red")
lines(dataPECsub$Sub_metering_3, col = "blue")
ymax1 <- max(dataPECsub$Sub_metering_1)
ymax2 <- max(dataPECsub$Sub_metering_2)
ymax3 <- max(dataPECsub$Sub_metering_3)
ymax <- 10*round(max(ymax1,ymax2,ymax3)/10, digits = 0)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2, col = "red")
lines(dataPECsub$Sub_metering_3, col = "blue")
g <- g + lines(dataPECsub$Sub_metering_3, col = "blue")
g <- g + lines(dataPECsub$Sub_metering_3, col = "blue")
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"),
lines(Sub_metering_2, col = "red"),
lines(Sub_metering_3, col = "blue"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"),
lines(Sub_metering_2, type = "l", col = "red"),
lines(Sub_metering_3, type = "l", col = "blue"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2, type = "l", col = "red")
lines(dataPECsub$Sub_metering_3, type = "l", col = "blue")
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2, type = "l", col = "red")
lines(dataPECsub$Sub_metering_3, type = "l", col = "blue")
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
lines(dataPECsub$Sub_metering_2, type = "l", col = "red")
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
lines(dataPECsub$Sub_metering_2, type = "l", col = "red")
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
col = "red"
ylim = c(0,ymax)))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
col = "red",
ylim = c(0,ymax)))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax)))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax)))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax)))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax)))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax)))
?plot
legend()
legend(2000,9.5,c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax)))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax)))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax)))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax)))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
line(dataPECsub$Sub_metering_3)
lines(dataPECsub$Sub_metering_3)
lines(dataPECsub$Sub_metering_3, ylim = c(0,ymax))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
legend("topright",c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"), lty =1, col = c("black","red","blue"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
# legend("topright",c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"), lty =1, col = c("black","red","blue"))
legend("topright",dataPECsub[7:8], lty =1, col = c("black","red","blue"))
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
lines(dataPECsub$Sub_metering_2,type = "l", col = "red")
?lines
lines(dataPECsub$Sub_metering_2,type = "l", col = "red", ylim = c(0,ymax))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
axes = FALSE))
#ylim = c(0,ymax),
# main = "Energy sub-metering versus Date & Time",
# xlab = "Date-Time",
# ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
axes = FALSE))
# ylim = c(0,ymax),
# main = "Energy sub-metering versus Date & Time",
# xlab = "Date-Time",
# ylab = "Energy sub-metering in Watts-hour"))
legend("topright",c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"), lty =1, col = c("black","red","blue"))
par(new = FALSE)
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
axes = FALSE))
# main = "Energy sub-metering versus Date & Time",
# xlab = "Date-Time",
# ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
axes = FALSE))
# main = "Energy sub-metering versus Date & Time",
# xlab = "Date-Time",
# ylab = "Energy sub-metering in Watts-hour"))
legend("topright",c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"), lty =1, col = c("black","red","blue"))
g <- with(dataPECsub, plot(Date, Sub_metering_1,
type = "l",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_2,
type = "l",
col = "red",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
par(new = TRUE)
g <- with(dataPECsub, plot(Date, Sub_metering_3,
type = "l",
col = "blue",
ylim = c(0,ymax),
main = "Energy sub-metering versus Date & Time",
xlab = "Date-Time",
ylab = "Energy sub-metering in Watts-hour"))
legend("topright",c("Energy sub-meter 1","Energy sub-meter 2","Energy sub-meter 3"), lty =1, col = c("black","red","blue"))
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
trainSpam$numType <- as.numeric(trainSpam$type) - 1
costFunction <- function(x,y) sum(x |= (y > 0.5))
cvError <- rep(NA, 55)
library(boot)
for (i in 1:55) {
lmFormula <- reformulate(names(trainSpam)[i], response = "numType")
glmFit <- glm(lmformula, family = "binomial", data = trainSpam)
cvError[i] <- cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
source('C:/Users/Kim/Dropbox/coursera/reproducible research/courses/week1/week1.R')
source('C:/Users/Kim/Dropbox/coursera/reproducible research/courses/week1/week1.R')
trainSpam$numType <- as.numeric(trainSpam$type) - 1
costFunction <- function(x,y) sum(x |= (y > 0.5))
cvError <- rep(NA, 55)
library(boot)
for (i in 1:55) {
lmFormula <- reformulate(names(trainSpam)[i], response = "numType")
glmFit <- glm(lmformula, family = "binomial", data = trainSpam)
cvError[i] <- cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
trainSpam$numType <- as.numeric(trainSpam$type) - 1
costFunction <- function(x,y) sum(x != (y > 0.5))
cvError <- rep(NA, 55)
library(boot)
for (i in 1:55) {
lmFormula <- reformulate(names(trainSpam)[i], response = "numType")
glmFit <- glm(lmformula, family = "binomial", data = trainSpam)
cvError[i] <- cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
source('C:/Users/Kim/Dropbox/coursera/reproducible research/courses/week1/week1.R')
install.packages("boot")
trainSpam$numType <- as.numeric(trainSpam$type) - 1
costFunction <- function(x,y) sum(x != (y > 0.5))
cvError <- rep(NA, 55)
library(boot)
for (i in 1:55) {
lmFormula <- reformulate(names(trainSpam)[i], response = "numType")
glmFit <- glm(lmformula, family = "binomial", data = trainSpam)
cvError[i] <- cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
trainSpam$numType <- as.numeric(trainSpam$type) - 1
costFunction <- function(x,y) sum(x != (y > 0.5))
cvError <- rep(NA, 55)
library(boot)
for (i in 1:55) {
lmFormula <- reformulate(names(trainSpam)[i], response = "numType")
glmFit <- glm(lmFormula, family = "binomial", data = trainSpam)
cvError[i] <- cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
names(trainSpam)[which.min(cvError)]
source('C:/Users/Kim/Dropbox/coursera/reproducible research/courses/week1/week1.R')
## Use the best model from the Group
predictionModel <- glm(numType ~ charDollar, family = "binomial", data = trainSpam)
## Get predictions on the test set
predictionTest <- predict(predictionMOdel, testSpam)
predictedSpam <- rep("nonspam", dim(testSpam)[1])
## Classify aqs "spam" for those with prob > 0.5
predictedSpam[predictionModel$fitter > 0.5] = "spam"
## Use the best model from the Group
predictionModel <- glm(numType ~ charDollar, family = "binomial", data = trainSpam)
## Get predictions on the test set
predictionTest <- predict(predictionMOdel, testSpam)
predictedSpam <- rep("nonspam", dim(testSpam)[1])
## Classify aqs "spam" for those with prob > 0.5
predictedSpam[predictionModel$fitter > 0.5] = "spam"
## Use the best model from the Group
predictionModel <- glm(numType ~ charDollar, family = "binomial", data = trainSpam)
## Get predictions on the test set
predictionTest <- predict(predictionModel, testSpam)
predictedSpam <- rep("nonspam", dim(testSpam)[1])
## Classify aqs "spam" for those with prob > 0.5
predictedSpam[predictionModel$fitter > 0.5] = "spam"
table(predictedSpam, testSpam$Type)
table(predictedSpam, testSpam$type)
?glm
??!=
source('C:/Users/Kim/Dropbox/coursera/reproducible research/courses/week1/week1.R')
?reformulate
## Classify aqs "spam" for those with prob > 0.5
predictedSpam[predictionModel$fitted > 0.5] = "spam"
table(predictedSpam, testSpam$type)
?source
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/project1.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/plot2.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/plot3.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/plot3.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/plot4.R')
source('C:/Users/Evi-Kimbo/Dropbox/coursera/exploratory data analysis/projects/project1/plot1.R')
